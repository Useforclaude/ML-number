# üìò Paperspace Complete Guide - Step by Step

**Created**: 2025-10-06
**For**: ML Phone Number Training on Paperspace
**Time needed**: ~25 minutes setup + 9-12 hours training

---

## üéØ Overview

‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡∏û‡∏≤‡∏Ñ‡∏∏‡∏ì‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà:
1. Login Paperspace
2. Create/Open Notebook
3. Setup environment
4. Fix dependencies
5. Upload data
6. Run training in Jupyter Lab

**‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢**: ‡πÄ‡∏£‡∏¥‡πà‡∏° training ‡∏ö‡∏ô Paperspace ‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏£‡∏≠ Kaggle

---

## üìã STEP 1: Login & Open Paperspace

### 1.1 Login
- ‡πÑ‡∏õ‡∏ó‡∏µ‡πà: https://console.paperspace.com/
- Login ‡∏î‡πâ‡∏ß‡∏¢ account

### 1.2 Navigate to Notebooks
```
Console ‚Üí Gradient ‚Üí Notebooks
```

### 1.3 Check Existing Notebooks
**‡∏ñ‡πâ‡∏≤‡∏°‡∏µ notebook ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß:**
- ‡∏Ñ‡∏•‡∏¥‡∏Å "Open" ‚Üí ‡∏Ç‡πâ‡∏≤‡∏°‡πÑ‡∏õ STEP 3

**‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ:**
- ‡∏ó‡∏≥ STEP 2 ‡∏ï‡πà‡∏≠

---

## üìã STEP 2: Create New Notebook (Optional)

### 2.1 Click "Create Notebook"

### 2.2 Configuration

**Machine Type:**
```
Free tier:
  ‚úÖ Free-GPU (Quadro M4000) ‚Üê ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ô‡∏µ‡πâ

Pro tier (‡∏ñ‡πâ‡∏≤‡∏à‡πà‡∏≤‡∏¢ $8/month):
  ‚≠ê P4000 (8GB VRAM)
  ‚≠ê P5000 (16GB VRAM)
```

**Container:**
```
Recommended:
  - Fast.ai (‡∏°‡∏µ PyTorch, Jupyter, GPU drivers)

Alternative:
  - PyTorch
  - TensorFlow
```

**Workspace:**
```
None (‡πÄ‡∏£‡∏≤‡∏à‡∏∞ clone ‡∏à‡∏≤‡∏Å GitHub)
```

**Advanced Options:**
```
Auto-shutdown:
  - Free: 6 hours (‡∏à‡∏∞‡∏õ‡∏¥‡∏î‡πÄ‡∏≠‡∏á)
  - Pro: Never / Custom (‡∏ï‡∏±‡πâ‡∏á‡πÄ‡∏≠‡∏á‡πÑ‡∏î‡πâ)

Persistent Storage:
  - Free: 5 GB (/storage)
  - Pro: 50 GB (/storage)
```

### 2.3 Start Notebook
- ‡∏Ñ‡∏•‡∏¥‡∏Å "Start Notebook"
- ‡∏£‡∏≠ 2-5 ‡∏ô‡∏≤‡∏ó‡∏µ
- ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô: "Running" (‡∏™‡∏µ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß)

### 2.4 Open Jupyter
- ‡∏Ñ‡∏•‡∏¥‡∏Å "Open"
- ‡∏à‡∏∞‡πÄ‡∏õ‡∏¥‡∏î Jupyter Lab (‡∏´‡∏£‡∏∑‡∏≠ Notebook)

---

## üìã STEP 3: Open Terminal in Jupyter

### ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà 1 - Jupyter Lab (Modern UI):
```
File ‚Üí New ‚Üí Terminal
```

### ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà 2 - Jupyter Notebook (Classic UI):
```
New (‡∏Ç‡∏ß‡∏≤‡∏ö‡∏ô) ‚Üí Terminal
```

**‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå:**
- ‡∏à‡∏∞‡πÄ‡∏´‡πá‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠ terminal ‡∏™‡∏µ‡∏î‡∏≥
- ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á

---

## üìã STEP 4: Clone Project & Setup

### 4.1 Check GPU (Optional)
```bash
nvidia-smi
```

**‡∏Ñ‡∏ß‡∏£‡πÄ‡∏´‡πá‡∏ô:**
```
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 525.xx       Driver Version: 525.xx       CUDA Version: 12.0    |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Quadro M4000        Off  | 00000000:00:05.0 Off |                  N/A |
| 46%   42C    P0    32W / 120W |      0MiB /  8192MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
```

### 4.2 Clone Project from GitHub
```bash
cd /storage
git clone https://github.com/Useforclaude/ML-number.git
cd ML-number
```

**‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö:**
```bash
pwd
# Expected: /storage/ML-number

ls -la
# ‡∏Ñ‡∏ß‡∏£‡πÄ‡∏´‡πá‡∏ô: src/, requirements.txt, README.md, etc.

ls src/
# ‡∏Ñ‡∏ß‡∏£‡πÄ‡∏´‡πá‡∏ô 17 files: config.py, model_utils.py, etc.
```

---

## üìã STEP 5: Fix Dependencies

### 5.1 Fix blinker conflict
```bash
pip install --ignore-installed blinker
```

**Expected output:**
```
Successfully installed blinker-1.9.0
```

### 5.2 Install ML Libraries (Essential 3)
```bash
pip install lightgbm==3.3.5
pip install catboost==1.2.8
pip install optuna==3.6.2
```

**Each should show:**
```
Successfully installed lightgbm-3.3.5
Successfully installed catboost-1.2.8
Successfully installed optuna-3.6.2
```

### 5.3 Validate Installation
```bash
python -c "import lightgbm; print('‚úÖ LightGBM OK')"
python -c "import catboost; print('‚úÖ CatBoost OK')"
python -c "import optuna; print('‚úÖ Optuna OK')"
python -c "import xgboost; print('‚úÖ XGBoost OK')"
python -c "import sklearn; print('‚úÖ scikit-learn OK')"
```

**‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏´‡πá‡∏ô‡∏ó‡∏±‡πâ‡∏á 5 ‚úÖ:**
```
‚úÖ LightGBM OK
‚úÖ CatBoost OK
‚úÖ Optuna OK
‚úÖ XGBoost OK
‚úÖ scikit-learn OK
```

### 5.4 Install Remaining Dependencies (Optional)
```bash
pip install -r requirements.txt
```

‡∏ñ‡πâ‡∏≤‡∏°‡∏µ error ‚Üí ‡∏Ç‡πâ‡∏≤‡∏°‡πÑ‡∏î‡πâ ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏Ç‡∏≠‡∏á‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏ï‡∏¥‡∏î‡πÅ‡∏•‡πâ‡∏ß (5.2)

---

## üìã STEP 6: Upload Data File

### 6.1 Create data directory
```bash
mkdir -p /storage/ML-number/data/raw
```

### 6.2 Upload numberdata.csv

**‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà 1 - ‡πÉ‡∏ä‡πâ Jupyter UI (‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥!):**

**‡πÉ‡∏ô Jupyter Lab:**
```
1. ‡∏ã‡πâ‡∏≤‡∏¢‡∏°‡∏∑‡∏≠: ‡∏Ñ‡∏•‡∏¥‡∏Å Folder icon üìÅ
2. Navigate: /storage/ML-number/data/raw/
   (‡∏Ñ‡∏•‡∏¥‡∏Å storage ‚Üí ML-number ‚Üí data ‚Üí raw)
3. ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏Ç‡∏ß‡∏≤‡πÉ‡∏ô‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ß‡πà‡∏≤‡∏á ‚Üí Upload Files
4. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå: numberdata.csv (‡∏à‡∏≤‡∏Å‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì)
5. ‡∏£‡∏≠ upload bar ‡πÄ‡∏™‡∏£‡πá‡∏à (‡∏Ñ‡∏ß‡∏£‡πÄ‡∏õ‡πá‡∏ô ~93 KB)
```

**‡πÉ‡∏ô Jupyter Notebook (Classic):**
```
1. Navigate to: /storage/ML-number/data/raw/
2. ‡∏Ñ‡∏•‡∏¥‡∏Å "Upload" (‡∏Ç‡∏ß‡∏≤‡∏ö‡∏ô)
3. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å numberdata.csv
4. ‡∏Ñ‡∏•‡∏¥‡∏Å "Upload" (‡∏™‡∏µ‡∏ü‡πâ‡∏≤) ‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠ confirm
```

**‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà 2 - ‡πÉ‡∏ä‡πâ Terminal (‡∏ñ‡πâ‡∏≤‡πÑ‡∏ü‡∏•‡πå‡∏≠‡∏¢‡∏π‡πà‡∏ó‡∏µ‡πà‡∏≠‡∏∑‡πà‡∏ô):**
```bash
cd /storage/ML-number/data/raw/

# Option A: Download from URL
wget https://your-url.com/numberdata.csv

# Option B: Copy from /tmp (‡∏ñ‡πâ‡∏≤ upload via Jupyter root)
cp /tmp/numberdata.csv .

# Option C: From local mounted drive (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)
cp /path/to/your/numberdata.csv .
```

### 6.3 Verify Data File
```bash
ls -lh /storage/ML-number/data/raw/numberdata.csv
```

**‡∏Ñ‡∏ß‡∏£‡πÄ‡∏´‡πá‡∏ô:**
```
-rw-r--r-- 1 root root 93K Oct  6 12:00 numberdata.csv
```

**‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤:**
```bash
head -5 /storage/ML-number/data/raw/numberdata.csv
```

**‡∏Ñ‡∏ß‡∏£‡πÄ‡∏´‡πá‡∏ô:**
```
phone_number,price
0812345678,5000
0899999999,150000
...
```

**‡∏ô‡∏±‡∏ö‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÅ‡∏ñ‡∏ß:**
```bash
wc -l /storage/ML-number/data/raw/numberdata.csv
```

**‡∏Ñ‡∏ß‡∏£‡πÄ‡∏´‡πá‡∏ô:**
```
6113 numberdata.csv  (6112 rows + 1 header)
```

---

## üìã STEP 7: Create Training Notebook

### 7.1 Create New Notebook

**‡πÉ‡∏ô Jupyter Lab:**
```
File ‚Üí New ‚Üí Notebook
Kernel: ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å "Python 3"
Save as: /storage/ML-number/train_paperspace.ipynb
```

**‡πÉ‡∏ô Jupyter Notebook:**
```
New ‚Üí Python 3
Rename: train_paperspace
```

### 7.2 Cell 1 - Setup Environment
```python
import sys
import os

# Add project to Python path
sys.path.insert(0, '/storage/ML-number')

print("="*80)
print("üîß ENVIRONMENT SETUP")
print("="*80)

# Verify path
print(f"‚úÖ Python path: {sys.path[0]}")
print(f"‚úÖ Working dir: {os.getcwd()}")

# Test imports
try:
    from src.config import BASE_PATH, MODEL_CONFIG
    from src.environment import get_config_for_environment

    env_config = get_config_for_environment()
    print(f"‚úÖ Environment: {env_config['ENV_TYPE']}")
    print(f"‚úÖ BASE_PATH: {BASE_PATH}")
    print(f"‚úÖ Imports working!")
except ImportError as e:
    print(f"‚ùå Import Error: {e}")
    print("‚ö†Ô∏è  Fix: Check if /storage/ML-number/src/ exists")

print("="*80)
```

**Run: Shift+Enter**

**‡∏Ñ‡∏ß‡∏£‡πÄ‡∏´‡πá‡∏ô:**
```
================================================================================
üîß ENVIRONMENT SETUP
================================================================================
‚úÖ Python path: /storage/ML-number
‚úÖ Working dir: /home/jovyan
‚úÖ Environment: paperspace
‚úÖ BASE_PATH: /storage/ML-number
‚úÖ Imports working!
================================================================================
```

### 7.3 Cell 2 - Load Data
```python
from src.data_loader import find_and_load_data
import pandas as pd

print("="*80)
print("üìä DATA LOADING")
print("="*80)

try:
    # Load data
    df_raw = find_and_load_data()

    print(f"‚úÖ Data loaded successfully!")
    print(f"‚úÖ Total rows: {len(df_raw)}")
    print(f"‚úÖ Columns: {df_raw.columns.tolist()}")
    print(f"‚úÖ Data types:\n{df_raw.dtypes}")

    # Show sample
    print(f"\nüìã First 5 rows:")
    print(df_raw.head())

    # Basic stats
    print(f"\nüìà Price statistics:")
    print(df_raw['price'].describe())

except Exception as e:
    print(f"‚ùå Error loading data: {e}")
    print("\n‚ö†Ô∏è  Troubleshooting:")
    print("   1. Check: ls /storage/ML-number/data/raw/numberdata.csv")
    print("   2. Upload numberdata.csv to /storage/ML-number/data/raw/")
    print("   3. Verify file has 6112 rows + header")

print("="*80)
```

**Run: Shift+Enter**

**‡∏Ñ‡∏ß‡∏£‡πÄ‡∏´‡πá‡∏ô:**
```
================================================================================
üìä DATA LOADING
================================================================================
‚úÖ Data loaded successfully!
‚úÖ Total rows: 6112
‚úÖ Columns: ['phone_number', 'price']
‚úÖ Data types:
phone_number    object
price          float64
dtype: object

üìã First 5 rows:
  phone_number    price
0   0812345678   5000.0
1   0899999999  150000.0
...
================================================================================
```

### 7.4 Cell 3 - Test GPU (Optional)
```python
import torch
import subprocess

print("="*80)
print("üñ•Ô∏è  GPU CHECK")
print("="*80)

# PyTorch GPU check
if torch.cuda.is_available():
    print(f"‚úÖ PyTorch GPU available!")
    print(f"   Device: {torch.cuda.get_device_name(0)}")
    print(f"   Memory: {torch.cuda.get_device_properties(0).total_memory / 1e9:.1f} GB")
    print(f"   CUDA Version: {torch.version.cuda}")
else:
    print("‚ö†Ô∏è  PyTorch: No GPU detected")
    print("   Training will use CPU (slower but works)")

# nvidia-smi check
print(f"\nüîç nvidia-smi output:")
try:
    result = subprocess.run(['nvidia-smi', '--query-gpu=name,memory.total,utilization.gpu',
                            '--format=csv,noheader'],
                           capture_output=True, text=True, timeout=5)
    if result.returncode == 0:
        print(f"   {result.stdout.strip()}")
    else:
        print("   ‚ö†Ô∏è  nvidia-smi not available")
except:
    print("   ‚ö†Ô∏è  nvidia-smi command failed")

print("="*80)
```

**Run: Shift+Enter**

**‡∏ñ‡πâ‡∏≤‡∏°‡∏µ GPU ‡∏Ñ‡∏ß‡∏£‡πÄ‡∏´‡πá‡∏ô:**
```
================================================================================
üñ•Ô∏è  GPU CHECK
================================================================================
‚úÖ PyTorch GPU available!
   Device: Quadro M4000
   Memory: 8.0 GB
   CUDA Version: 12.0

üîç nvidia-smi output:
   Quadro M4000, 8192 MiB, 0 %
================================================================================
```

**‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ GPU:**
```
‚ö†Ô∏è  PyTorch: No GPU detected
   Training will use CPU (slower but works)
```
‚Üí ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Notebook Settings ‚Üí Instance Type ‚Üí ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡πá‡∏ô "Free-GPU"

### 7.5 Cell 4 - Start Training (MAIN)
```python
from src.train_production import train_production_models
import time

print("="*80)
print("üöÄ ML TRAINING - PRODUCTION MODE")
print("="*80)

# Configuration
config = {
    'optimize': True,        # Use Optuna hyperparameter optimization
    'n_trials': 100,         # Number of Optuna trials (100 = ~9-12 hours)
    'use_gpu': True,         # Auto-fallback to CPU if GPU fails
    'verbose': True          # Show detailed progress
}

print(f"üìã Training Configuration:")
print(f"   Optimization: {config['optimize']}")
print(f"   Optuna Trials: {config['n_trials']}")
print(f"   GPU Enabled: {config['use_gpu']}")
print(f"   Verbose: {config['verbose']}")
print(f"\n‚è±Ô∏è  Estimated Time:")
print(f"   With GPU: ~9-12 hours")
print(f"   CPU only: ~18-24 hours")
print(f"\nüíæ Progress saved to:")
print(f"   Checkpoints: /storage/ML-number/checkpoints/")
print(f"   Models: /storage/ML-number/models/")
print("\n" + "="*80)
print("‚ö†Ô∏è  DO NOT CLOSE THIS NOTEBOOK DURING TRAINING!")
print("="*80 + "\n")

# Confirm before starting
input("Press ENTER to start training (or Ctrl+C to cancel)...")

# Start training
start_time = time.time()

try:
    results = train_production_models(
        optimize=config['optimize'],
        n_trials=config['n_trials'],
        use_gpu=config['use_gpu'],
        verbose=config['verbose']
    )

    elapsed = time.time() - start_time

    print("\n" + "="*80)
    print("‚úÖ TRAINING COMPLETE!")
    print("="*80)
    print(f"‚è±Ô∏è  Total time: {elapsed/3600:.2f} hours")
    print(f"üéØ Best R¬≤ Score: {results.get('best_r2', 'N/A'):.4f}")
    print(f"üèÜ Best Model: {results.get('best_model_name', 'N/A')}")
    print(f"üíæ Model saved to: /storage/ML-number/models/deployed/best_model.pkl")
    print("="*80)

except KeyboardInterrupt:
    print("\n‚ö†Ô∏è  Training interrupted by user!")
    print("üíæ Checkpoints saved - you can resume later")
except Exception as e:
    print(f"\n‚ùå Training error: {e}")
    import traceback
    traceback.print_exc()
```

**IMPORTANT: ‡∏Å‡πà‡∏≠‡∏ô Run Cell ‡∏ô‡∏µ‡πâ**
```
1. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Cells 1-3 ‡∏ú‡πà‡∏≤‡∏ô‡∏´‡∏°‡∏î‡πÅ‡∏•‡πâ‡∏ß (‚úÖ)
2. Data loaded ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢ (‚úÖ)
3. Save notebook (Ctrl+S ‡∏´‡∏£‡∏∑‡∏≠ Cmd+S)
4. ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡πÉ‡∏à‡∏ß‡πà‡∏≤‡∏à‡∏∞‡∏£‡∏≠ 9-12 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á
```

**Run: Shift+Enter**

‡∏à‡∏∞‡πÄ‡∏´‡πá‡∏ô:
```
Press ENTER to start training (or Ctrl+C to cancel)...
```

‡∏Å‡∏î **Enter** ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏° training

---

## üìä What to Expect During Training

### Phase 1: XGBoost (GPU) - ~2.5 hours
```
================================================================================
üî• Training XGBoost (GPU)
================================================================================
      üî• XGBoost using GPU (device=cuda)

üìà Progress: 1/100 (1.0%) | ETA: 2.4 hours
üìà Progress: 2/100 (2.0%) | ETA: 2.3 hours
...
[03:45:12] üî• GPU: 87% | Mem: 1234 MiB / 8192 MiB | Temp: 62¬∞C
```

### Phase 2: LightGBM (CPU) - ~3.5 hours
```
================================================================================
üî• Training LightGBM (CPU - Auto-fallback)
================================================================================
      üî¨ Testing LightGBM GPU compilation...
      ‚ö†Ô∏è  GPU test failed: ... (expected)
      üîÑ Automatically falling back to CPU for LightGBM
      ‚ö™ LightGBM using CPU (device=cpu)

üìà Progress: 1/100 (1.0%) | ETA: 3.4 hours ‚Üê MUST SEE THIS!
üìà Progress: 2/100 (2.0%) | ETA: 3.3 hours
...
```

**‚ö†Ô∏è  CRITICAL: ‡∏ñ‡πâ‡∏≤ LightGBM stuck at 0/100 > 5 minutes:**
‚Üí ‡∏Å‡∏î "Interrupt Kernel" (‚¨õ icon)
‚Üí ‡∏°‡∏µ‡∏õ‡∏±‡∏ç‡∏´‡∏≤ n_jobs bug (‡πÑ‡∏°‡πà‡∏ô‡πà‡∏≤‡πÄ‡∏Å‡∏¥‡∏î‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡πÉ‡∏ä‡πâ HANG-FIX)

### Phase 3: CatBoost (GPU) - ~1.5 hours
```
================================================================================
üî• Training CatBoost (GPU)
================================================================================
      üî• CatBoost using GPU (task_type=GPU)

üìà Progress: 1/50 (2.0%) | ETA: 1.4 hours
...
[07:15:23] üî• GPU: 78% | Mem: 2145 MiB / 8192 MiB | Temp: 68¬∞C
```

### Phase 4: RandomForest (CPU) - ~1 hour
```
================================================================================
üî• Training RandomForest (CPU)
================================================================================
      ‚ö™ RandomForest using CPU (n_jobs=-1)

üìà Progress: 1/50 (2.0%) | ETA: 58 min
...
```

### Phase 5: Ensemble - ~15 min
```
================================================================================
üî• Creating Ensemble Models
================================================================================
‚úÖ Weighted Ensemble created
‚úÖ Stacking Ensemble created
‚úÖ Optimized Stacking created
```

---

## ‚úÖ Verification During Training

### Every 30 minutes, check:

**1. Progress is moving:**
```
üìà Progress: X/100 (increasing)
```

**2. GPU is utilized (if available):**
```
[HH:MM:SS] üî• GPU: 70-100% (XGBoost, CatBoost)
[HH:MM:SS] ‚ö™ GPU: 0% (LightGBM - CPU only, expected)
```

**3. Checkpoints are saving:**
```
üíæ Checkpoint saved: checkpoint_YYYYMMDD_HHMMSS.json
```

**4. No errors:**
```
‚ùå Error: ... ‚Üê ‡πÑ‡∏°‡πà‡∏Ñ‡∏ß‡∏£‡πÄ‡∏´‡πá‡∏ô
```

---

## üíæ After Training Completes

### 7.6 Cell 5 - Verify Results
```python
import joblib
import json
from pathlib import Path

print("="*80)
print("üîç VERIFICATION - Model & Results")
print("="*80)

# Check model file
model_path = Path('/storage/ML-number/models/deployed/best_model.pkl')
if model_path.exists():
    print(f"‚úÖ Model found: {model_path}")
    print(f"   Size: {model_path.stat().st_size / 1024:.1f} KB")

    # Load model
    deployment = joblib.load(model_path)
    print(f"\nüìä Model Details:")
    print(f"   Name: {deployment.get('model_name', 'Unknown')}")
    print(f"   R¬≤ Score: {deployment.get('r2_score', 'N/A'):.4f}")
    print(f"   Features: {len(deployment.get('feature_names', []))}")
    print(f"   Timestamp: {deployment.get('timestamp', 'N/A')}")
else:
    print(f"‚ùå Model not found: {model_path}")

# Check checkpoints
checkpoint_dir = Path('/storage/ML-number/checkpoints/')
checkpoints = sorted(checkpoint_dir.glob('*.json'))
print(f"\nüíæ Checkpoints found: {len(checkpoints)}")
if checkpoints:
    latest = checkpoints[-1]
    print(f"   Latest: {latest.name}")
    with open(latest) as f:
        data = json.load(f)
        print(f"   Timestamp: {data.get('timestamp', 'N/A')}")

print("="*80)
```

### 7.7 Cell 6 - Test Prediction
```python
# Test single prediction
test_numbers = [
    '0899999999',  # Very lucky (9999)
    '0812345678',  # Sequential
    '0888888888',  # All 8s
]

print("="*80)
print("üß™ TEST PREDICTIONS")
print("="*80)

for number in test_numbers:
    # Create features (simplified - full pipeline in actual code)
    print(f"\nüì± Number: {number}")
    print(f"   Predicted price: ‡∏ø{100000:,.0f}  (‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á)")
    # Note: ‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ full pipeline ‡∏à‡∏£‡∏¥‡∏á‡πÜ ‡∏à‡∏≤‡∏Å src/

print("="*80)
```

---

## üì• Download Model

### ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà 1 - Jupyter UI (‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥):
```
1. ‡πÉ‡∏ô Jupyter Lab ‡∏ã‡πâ‡∏≤‡∏¢‡∏°‡∏∑‡∏≠: Navigate to /storage/ML-number/models/deployed/
2. ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏Ç‡∏ß‡∏≤‡∏ó‡∏µ‡πà best_model.pkl
3. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å "Download"
4. Save ‡πÑ‡∏ß‡πâ‡∏ó‡∏µ‡πà‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
```

### ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà 2 - Terminal:
```bash
# Copy to accessible location
cp /storage/ML-number/models/deployed/best_model.pkl ~/best_model.pkl

# Then download via Jupyter UI from home directory
```

---

## üîß Troubleshooting

### Issue 1: Import Error
```python
ImportError: No module named 'src.config'
```

**Fix:**
```python
# Cell 1 - Add this at top
import sys
sys.path.insert(0, '/storage/ML-number')
```

### Issue 2: Data File Not Found
```python
FileNotFoundError: numberdata.csv
```

**Fix:**
```bash
# In terminal
ls -la /storage/ML-number/data/raw/
# ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÑ‡∏ü‡∏•‡πå ‚Üí Upload again (STEP 6.2)
```

### Issue 3: GPU Not Detected
```
‚ö†Ô∏è  PyTorch: No GPU detected
```

**Fix:**
```
1. Stop notebook
2. Notebook Settings ‚Üí Instance Type
3. Change to: Free-GPU (M4000) or P4000/P5000
4. Start notebook again
5. Re-run Cell 3 to verify
```

### Issue 4: Training Hangs (LightGBM)
```
LightGBM: 0/100 (stuck for > 5 minutes)
```

**Fix:**
```
1. Kernel ‚Üí Interrupt Kernel
2. Check src/model_utils.py line 596, 603
3. Should be: n_jobs=1 (not n_jobs=-1)
4. If wrong ‚Üí Update from GitHub:
   cd /storage/ML-number
   git pull origin main
5. Restart kernel + re-run
```

### Issue 5: Out of Memory
```
CUDA out of memory
```

**Fix:**
```python
# In Cell 4, reduce n_trials:
config = {
    'n_trials': 50,  # Reduce from 100
    ...
}
```

### Issue 6: Kernel Died
```
Kernel died, restarting...
```

**Fix:**
```
1. Don't panic - checkpoints are saved!
2. Kernel ‚Üí Restart Kernel
3. Re-run Cells 1-2 (setup + data)
4. Skip Cell 4 (training) if already running
5. Check: /storage/ML-number/checkpoints/ for progress
```

---

## üìä Expected Results

### Successful Training:
```
‚úÖ Training complete in ~9-12 hours (GPU) or 18-24 hours (CPU)
‚úÖ R¬≤ Score > 0.90 (target: 0.93+)
‚úÖ Model saved: /storage/ML-number/models/deployed/best_model.pkl
‚úÖ Checkpoints: 15-20 files in checkpoints/
‚úÖ No errors in output
```

### What Good Looks Like:
```
üéØ Best R¬≤ Score: 0.9324
üèÜ Best Model: Optimized_Stacking
üíæ Model saved to: /storage/ML-number/models/deployed/best_model.pkl
```

---

## üÜò Need Help?

**During setup (STEP 1-6):**
- ‡∏ñ‡πâ‡∏≤‡∏ï‡∏¥‡∏î‡∏Ç‡∏±‡∏î ‚Üí ‡∏ñ‡∏≤‡∏°‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢ ‡∏°‡∏µ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏û‡∏£‡πâ‡∏≠‡∏° copy-paste

**During training (STEP 7):**
- ‡∏ñ‡πâ‡∏≤ progress ‡πÑ‡∏°‡πà‡∏Ç‡∏¢‡∏±‡∏ö > 10 min ‚Üí Interrupt + Report
- ‡∏ñ‡πâ‡∏≤ error ‚Üí Copy error message ‚Üí Report

**After training:**
- ‡∏ñ‡πâ‡∏≤ R¬≤ < 0.80 ‚Üí Review training logs
- ‡∏ñ‡πâ‡∏≤ model file missing ‚Üí Check checkpoints/

---

## üìö Related Files

- **Setup**: `PAPERSPACE_SETUP.md`
- **Validation**: `validate_paperspace.py`
- **Error Prevention**: `PAPERSPACE_ERROR_PREVENTION.md`
- **GPU Config**: `PAPERSPACE_GPU_CONFIG_USAGE.md`
- **Main Docs**: `CLAUDE.md`, `README.md`

---

**Created**: 2025-10-06
**Version**: HANG-FIX compatible
**Platform**: Paperspace Gradient
**GPU**: M4000/P4000/P5000 (auto-detect)
**Training Time**: ~9-12 hours (GPU) / 18-24 hours (CPU)

üéâ **Ready to start training!** Follow STEP 1 ‚Üí STEP 7 ‚Üí Wait ‚Üí Download model
